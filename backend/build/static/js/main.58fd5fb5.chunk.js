(this["webpackJsonpdate-selector"]=this["webpackJsonpdate-selector"]||[]).push([[0],{281:function(e,t,n){"use strict";n.r(t);var a,r,s,c,o,i,u,d,j,l,b,m,O,h,v,g,p,x,f,y,D,w,N,S,$,q,C=n(37),k=n(1),M=n(67),V=n.n(M),I=n(7),E=n(11),G=n.n(E),U=n(21),Q=n(41),B=n(9),T=n(50),_=n(0),A=T.a().shape({username:T.b().required("Username is required").min(3,"Username needs to be atleast 3 characters"),password:T.b().required("Password is required").min(8,"Password needs to be atleast 8 characters")}),H=function(e){var t=e.login;return Object(_.jsxs)("div",{children:[Object(_.jsx)("h1",{children:"Login"}),Object(_.jsx)(Q.a,{initialValues:{username:"",password:""},onSubmit:function(){var e=Object(U.a)(G.a.mark((function e(n,a){var r,s,c;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.username,s=n.password,c=a.resetForm,e.next=4,t({username:r,password:s});case 4:c({values:{username:"",password:""}});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),validationSchema:A,children:function(e){var t=e.values,n=e.handleChange,a=e.handleBlur,r=e.handleSubmit,s=e.isValid,c=e.dirty;return Object(_.jsxs)("form",{onSubmit:r,children:["username: ",Object(_.jsx)("input",{id:"username",type:"text",name:"username",onChange:n,onBlur:a,value:t.username}),Object(_.jsx)("br",{}),"password: ",Object(_.jsx)("input",{id:"password",type:"password",name:"password",onChange:n,onBlur:a,value:t.password}),Object(_.jsx)("br",{}),s&&c?Object(_.jsx)("button",{type:"submit",id:"login-button",children:"Login"}):null]})}}),Object(_.jsx)("h2",{children:"Not yet signed in?"}),Object(_.jsx)("button",{id:"signIn-button",children:Object(_.jsx)(B.b,{to:"SignIn",children:"Sign In"})})]})},Y=T.a().shape({username:T.b().required("Username is required").min(3),name:T.b().required("Name is required").min(3),password:T.b().required("Password is required").min(8)}),P=function(e){var t=e.login,n=e.signIn,a=function(){var e=Object(U.a)(G.a.mark((function e(a,r){var s,c,o,i,u;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=a.username,c=a.name,o=a.password,i=r.resetForm,e.next=4,n(s,c,o);case 4:if(u=e.sent,console.log(u),!u){e.next=9;break}return e.next=9,t({username:s,password:o});case 9:i({values:{username:"",password:"",name:""}});case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(_.jsxs)("div",{children:[Object(_.jsx)("h1",{children:"Sign In"}),Object(_.jsx)(Q.a,{initialValues:{username:"",password:"",name:""},onSubmit:a,validationSchema:Y,children:function(e){var t=e.values,n=e.handleChange,a=e.handleBlur,r=e.handleSubmit,s=e.isValid;return Object(_.jsxs)("form",{onSubmit:r,children:["username: ",Object(_.jsx)("input",{id:"username",type:"text",name:"username",onChange:n,onBlur:a,value:t.username}),Object(_.jsx)("br",{}),"name: ",Object(_.jsx)("input",{id:"name",type:"text",name:"name",onChange:n,onBlur:a,value:t.name}),Object(_.jsx)("br",{}),"password: ",Object(_.jsx)("input",{id:"password",type:"text",name:"password",onChange:n,onBlur:a,value:t.password}),Object(_.jsx)("br",{}),s?Object(_.jsx)("button",{type:"submit",id:"submit-button",children:"Sign In"}):null]})}})]})},F=n(5),R=n(17),L=Object(F.gql)(a||(a=Object(R.a)(["\nmutation login($username: String!, $password: String!){\n  login(username: $username, password: $password){value}\n}"]))),J=Object(F.gql)(r||(r=Object(R.a)(["\nmutation addEvent($name: String! $group: String! $dates: [String!]!){\n  addEvent(name: $name, group: $group dates: $dates){name id}\n}"]))),W=Object(F.gql)(s||(s=Object(R.a)(["\nmutation createUser($name: String! $username: String! $password: String!){\n  createUser(name: $name, username: $username, password: $password){name}\n}"]))),z=Object(F.gql)(c||(c=Object(R.a)(["\nmutation addGroup($name: String! $users: [String]!){\n  createGroup(name: $name, users: $users){name id}\n}"]))),K=(Object(F.gql)(o||(o=Object(R.a)(["\nmutation joinGroup($id: ID!){\n  joinGroup(id: $id){\n    name \n    id\n  }\n}"]))),Object(F.gql)(i||(i=Object(R.a)(["\nmutation voteEvent($id: ID!, $votes: [VoteInput]!){\n  voteEvent(id: $id, votes: $votes){\n    name \n    id\n    status \n    dates{\n      votes{\n        voter \n        vote}\n      }\n    }\n}"])))),X=Object(F.gql)(u||(u=Object(R.a)(["\nmutation leaveGroup($id: ID!){\n  leaveGroup(id: $id){\n    name\n    id\n  }\n}"]))),Z=Object(F.gql)(d||(d=Object(R.a)(["\nmutation removeFromGroup($group: String!, $user: String!){\n  removeFromGroup(group: $group, user: $user){\n    id\n  }\n}"]))),ee=Object(F.gql)(j||(j=Object(R.a)(["\nmutation addToAdmins($group: String!, $user: String!){\n  addToAdmins(group: $group, user: $user){\n    name\n    username\n    id\n  }\n}"]))),te=Object(F.gql)(l||(l=Object(R.a)(["\nmutation addToGroup($group: String!, $user: String!){\n  addToGroup(group: $group, user: $user){\n    name\n    username\n    id\n  }\n}"]))),ne=Object(F.gql)(b||(b=Object(R.a)(["\nmutation readMessage($id: ID!){\n  readMessage(id: $id){read}\n}"]))),ae=Object(F.gql)(m||(m=Object(R.a)(["\nmutation sendUserMessage($receivers: [String!]!, $message: String!, $title: String!){\n  sendUserMessage(receivers: $receivers, message: $message, title: $title){\n    title\n    receivers\n    content\n  }\n}"]))),re=Object(F.gql)(O||(O=Object(R.a)(["\nmutation joinRequest($group: String!){\n  joinRequest(group: $group){name}\n}"]))),se=Object(F.gql)(h||(h=Object(R.a)(["\nmutation deleteMessage($id: ID!){\n  deleteMessage(id: $id)\n}"]))),ce=Object(F.gql)(v||(v=Object(R.a)(["\nquery{\n  me{\n    name\n    username\n    id\n    events{\n      name\n      id\n      status\n      finalDate\n    }\n    unReadMessagesCount\n  }\n}"]))),oe=Object(F.gql)(g||(g=Object(R.a)(["\nquery{\n  me{\n    messages{\n      id\n      title\n      read\n      sender\n    }\n  }\n}"]))),ie=Object(F.gql)(p||(p=Object(R.a)(["\nquery{\n  me{\n    id\n  }\n}"]))),ue=(Object(F.gql)(x||(x=Object(R.a)(["\nquery{\n  allEvents{\n    name\n  }\n}"]))),Object(F.gql)(f||(f=Object(R.a)(["\nquery{\n  me{\n    id\n    groups{\n      name\n      id\n    }\n  }\n}"])))),de=Object(F.gql)(y||(y=Object(R.a)(["\nquery event($id: ID!){\n  event(id: $id){\n    name\n    id\n    status\n    finalDate\n    dates{\n      date\n      votes{\n        voter\n        vote\n      }\n    }\n    bestDates{\n      date\n      votes{\n        voter\n        vote\n      }\n    }\n  }\n}"]))),je=Object(F.gql)(D||(D=Object(R.a)(["\nquery group($name: String!){\n  group(name: $name){\n    name\n    id\n    users{\n      name\n      username\n      id\n    }\n    admins{\n      name\n      username\n      id\n    }\n  }\n}"]))),le=Object(F.gql)(w||(w=Object(R.a)(["\nquery message($id: ID!){\n  message(id: $id){\n    title\n    sender\n    receivers\n    type\n    ... on JoiningRequest {\n      group\n    }\n    ... on UserMessage {\n      content\n    }\n  }\n}"]))),be=Object(F.gql)(N||(N=Object(R.a)(["\nquery{\n  me{\n    id\n    groupsUserNotIn{\n      name\n      id\n    }\n  }\n}"]))),me=Object(F.gql)(S||(S=Object(R.a)(["\nquery user($username: String!){\n  user(username: $username){\n    name\n    id\n  }\n}"]))),Oe=(Object(F.gql)($||($=Object(R.a)(["\nquery{\n  allGroups{\n    name\n    id\n  }\n}"]))),Object(F.gql)(q||(q=Object(R.a)(["\nquery UsersNotInGroup($name: String!){\n  group(name: $name){\n    id\n    name\n    usersNotInGroup{\n      name\n      id\n      username\n    }\n  }\n}"])))),he=n(153),ve=n(151),ge=n(282),pe=n(289),xe=n(283),fe=n(284),ye=n(285),De=n(286),we=n(287),Ne=n(288),Se=(n(57),function(e){var t=e.month,n=e.setMonth;return Object(_.jsxs)("div",{className:"header row flex-middle",children:[Object(_.jsx)("div",{className:"col col-start",children:Object(_.jsx)("div",{className:"icon",onClick:function(){n(ge.a(t,1))},children:"chevron_left"})}),Object(_.jsx)("div",{className:"col col-center",children:Object(_.jsx)("span",{children:pe.a(t,"MMMM YYYYY")})}),Object(_.jsx)("div",{className:"col col-end",onClick:function(){n(ve.a(t,1))},children:Object(_.jsx)("div",{className:"icon",children:"chevron_right"})})]})}),$e=function(e){var t=e.month,n=xe.a(t),a=Array.from(Array(7)).map((function(e,t){return Object(_.jsx)("div",{className:"col col-center",children:pe.a(fe.a(n,t),"EEEEEE")},t)}));return Object(_.jsx)("div",{className:"days row",children:a})},qe=function(e){for(var t=e.month,n=e.setDates,a=e.dates,r=ye.a(t),s=De.a(r),c=xe.a(r),o=we.a(s),i=[],u=[],d=c,j="";d<=o;){for(var l=0;l<7;l++){j=pe.a(d,"d");var b=d;u.push(Object(_.jsx)(Ce,{formattedDate:j,day:b,monthStart:r,setDates:n,dates:a},b)),d=fe.a(d,1)}i.push(Object(_.jsx)("div",{className:"row",children:u},d)),u=[]}return Object(_.jsx)("div",{className:"body",children:i})},Ce=function(e){var t=e.formattedDate,n=e.day,a=e.monthStart,r=e.setDates,s=e.dates,c=Object(k.useState)(!1),o=Object(I.a)(c,2),i=o[0],u=o[1],d="col cell default";return(!Ne.a(n,a)||parseInt(pe.a(n,"DDD"))<parseInt(pe.a(new Date,"DDD")))&&(d="col cell disabled"),i&&(d="col cell green"),Object(_.jsxs)("div",{id:"dates-".concat(t),className:d,onClick:function(){return function(e){u(!i),r(s.concat(e))}(n)},children:[Object(_.jsx)("span",{className:"number",children:t}),Object(_.jsx)("span",{className:"bg",children:t})]},n)},ke=function(e){var t=e.setDates,n=e.dates,a=Object(k.useState)(new Date),r=Object(I.a)(a,2),s=r[0],c=r[1];return Object(_.jsxs)("div",{className:"calendar",children:[Object(_.jsx)(Se,{month:s,setMonth:c}),Object(_.jsx)($e,{month:s}),Object(_.jsx)(qe,{month:s,setDates:t,dates:n})]})},Me=function(){return Object(_.jsx)("div",{children:"...loading"})},Ve=function(e){var t=e.setNotification,n=Object(k.useState)([]),a=Object(I.a)(n,2),r=a[0],s=a[1],c=Object(k.useState)(null),o=Object(I.a)(c,2),i=o[0],u=o[1],d=Object(F.useQuery)(ue),j=[];d.data&&(j=d.data.me.groups.map((function(e){return{value:e.name,label:e.name}})));var l=Object(F.useMutation)(J,{update:function(e,t){console.log("dataInStore:");var n=e.readQuery({query:ce});if(n){var a=n.me.events;console.log(n.me),console.log(a),console.log(t),e.writeQuery({query:ce,data:{me:Object(C.a)(Object(C.a)({},n.me),{},{events:a.concat(t.data.addEvent)})}})}}}),b=Object(I.a)(l,1)[0];return d.data?0===j.length&&d.data?Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{children:"You need to be part of group to add events"}),Object(_.jsx)("h2",{children:Object(_.jsx)(B.b,{to:"/joinGroup",children:"Join Here"})})]}):Object(_.jsxs)("div",{children:[Object(_.jsx)("h1",{children:"New Event"}),Object(_.jsx)(Q.a,{initialValues:{name:""},onSubmit:function(e,n){var a=e.name,s=n.resetForm;0===r.length?(t({message:"pick possible dates",error:!0}),setTimeout((function(){t(null)}),5e3)):i?(b({variables:{name:a,group:i,dates:r}}),t({message:"added event ".concat(a," to group ").concat(i),error:!1}),setTimeout((function(){t(null)}),5e3),s({})):(t({message:"pick group to add event",error:!0}),setTimeout((function(){t(null)}),5e3))},children:function(e){var t=e.values,n=e.handleChange,a=e.handleBlur,r=e.handleSubmit;return Object(_.jsxs)("form",{onSubmit:r,children:["event name: ",Object(_.jsx)("input",{id:"name",type:"text",name:"name",onChange:n,onBlur:a,value:t.name}),Object(_.jsx)("button",{id:"submit-button",type:"submit",children:"Submit"})]})}}),Object(_.jsx)(he.a,{id:"group-options",options:j,onChange:function(e){u(e.value)}}),Object(_.jsx)("h2",{children:"Choose possible days"}),Object(_.jsx)(ke,{dates:r,setDates:s}),Object(_.jsxs)("button",{id:"homepage-button",children:[" ",Object(_.jsx)(B.b,{to:"/",children:"Home Page"})]})]}):Object(_.jsx)(Me,{})},Ie=function(e){var t=e.setNotification,n=Object(F.useMutation)(z,{update:function(e,t){var n=e.readQuery({query:ue});n&&e.writeQuery({query:ue,data:{me:Object(C.a)(Object(C.a)({},n.me),{},{groups:n.me.groups.concat(t.data.createGroup)})}})}}),a=Object(I.a)(n,1)[0],r=Object(k.useState)([]),s=Object(I.a)(r,2),c=s[0],o=s[1];return Object(_.jsxs)("div",{children:[Object(_.jsx)("h1",{children:"New Group"}),Object(_.jsx)(Q.a,{initialValues:{name:"",user:""},onSubmit:function(){var e=Object(U.a)(G.a.mark((function e(n,r){var s,o;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.name,o=r.resetForm,e.next=4,a({variables:{name:s,users:c}});case 4:t({message:"added group ".concat(s),error:!1}),setTimeout((function(){t(null)}),5e3),o({}),o({});case 8:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.handleChange,a=e.handleBlur,r=e.handleSubmit,s=e.setFieldValue;return Object(_.jsxs)("form",{onSubmit:r,children:["group name: ",Object(_.jsx)("input",{id:"name",type:"text",name:"name",onChange:n,onBlur:a,value:t.name}),Object(_.jsx)("br",{}),"users: ",Object(_.jsx)("input",{id:"user",type:"text",name:"user",onChange:n,onBlur:a,value:t.user}),Object(_.jsx)("button",{type:"button",id:"add-user-button",onClick:function(){o(c.concat(t.user)),s("user","")},children:"add user"}),Object(_.jsx)("br",{}),c.join(" "),Object(_.jsx)("br",{}),Object(_.jsx)("button",{id:"submit-button",type:"submit",children:"Submit"})]})}}),Object(_.jsxs)("button",{id:"homepage-button",children:[" ",Object(_.jsx)(B.b,{to:"/",children:"Home Page"})]})]})},Ee=n(23),Ge=n(25),Ue=function(e){var t=e.month,n=e.setMonth;return Object(_.jsxs)("div",{className:"header row flex-middle",children:[Object(_.jsx)("div",{className:"col col-start",children:Object(_.jsx)("div",{className:"icon",onClick:function(){n(ge.a(t,1))},children:"chevron_left"})}),Object(_.jsx)("div",{className:"col col-center",children:Object(_.jsx)("span",{children:pe.a(t,"MMMM YYYYY")})}),Object(_.jsx)("div",{className:"col col-end",onClick:function(){n(ve.a(t,1))},children:Object(_.jsx)("div",{className:"icon",children:"chevron_right"})})]})},Qe=function(e){var t=e.month,n=xe.a(t),a=Array.from(Array(7)).map((function(e,t){return Object(_.jsx)("div",{className:"col col-center",children:pe.a(fe.a(n,t),"EEEEEE")},t)}));return Object(_.jsx)("div",{className:"days row",children:a})},Be=function(e){for(var t=e.month,n=e.dates,a=e.setVotes,r=e.votes,s=ye.a(t),c=De.a(s),o=xe.a(s),i=we.a(c),u=[],d=[],j=o,l="";j<=i;){for(var b=0;b<7;b++){l=pe.a(j,"d");var m=j;d.push(Object(_.jsx)(_e,{formattedDate:l,day:m,monthStart:s,dates:n,setVotes:a,votes:r},m)),j=fe.a(j,1)}u.push(Object(_.jsx)("div",{className:"row",children:d},j)),d=[]}return Object(_.jsx)("div",{className:"body",children:u})},Te=function(e){var t=e.day,n=e.formattedDate,a=e.votes,r=e.setVotes,s=Object(k.useState)(""),c=Object(I.a)(s,2),o=c[0],i=c[1],u=Object(Ge.a)(a);console.log(u);var d=u.findIndex((function(e){return pe.a(e.date,"DDD")===pe.a(t,"DDD")}));Object(k.useEffect)((function(){u[d]&&i(u[d].vote)}),[d]);return console.log(o),Object(_.jsxs)("div",{onClick:function(){return function(e){console.log(t),parseInt(pe.a(t,"DDD"))<parseInt(pe.a(new Date,"DDD"))||("blue"===e?(i("green"),u[d].vote="green",r(u)):"green"===e?(i("red"),u[d].vote="red",r(u)):(i("blue"),u[d].vote="blue",r(u)))}(o)},id:"dates-".concat(n),className:"col cell ".concat(o),children:[Object(_.jsx)("span",{className:"number",children:n}),Object(_.jsx)("span",{className:"bg",children:n})]},t)},_e=function(e){var t=e.formattedDate,n=e.day,a=e.monthStart,r=e.dates,s=e.setVotes,c=e.votes;return r.map((function(e){return pe.a(e,"d")})).includes(pe.a(n,"d"))?(console.log("FOUND"),Object(_.jsx)(Te,{setVotes:s,votes:c,day:n,formattedDate:t})):Object(_.jsxs)("div",{className:"col cell ".concat(Ne.a(n,a)?"":"disabled"),children:[Object(_.jsx)("span",{className:"number",children:t}),Object(_.jsx)("span",{className:"bg",children:t})]},n)},Ae=function(e){var t=e.dates,n=e.setVotes,a=e.votes,r=Object(k.useState)(new Date),s=Object(I.a)(r,2),c=s[0],o=s[1];return Object(_.jsxs)("div",{className:"calendar",children:[Object(_.jsx)(Ue,{month:c,setMonth:o}),Object(_.jsx)(Qe,{month:c}),Object(_.jsx)(Be,{month:c,dates:t,setVotes:n,votes:a})]})},He=function(e){return console.log(e),new Date(e)},Ye=function(e){var t=e.event,n=e.user,a=e.setNotification,r=Object(k.useState)([]),s=Object(I.a)(r,2),c=s[0],o=s[1];Object(k.useEffect)((function(){if(t&&n){var e=t.dates.map((function(e){return{date:He(e.date),vote:"blue"}}));0!==t.dates[0].votes.filter((function(e){return e.voter===n.username})).length&&(e=t.dates.map((function(e){return{date:He(e.date),vote:e.votes.find((function(e){return e.voter===n.username})).vote}}))),e.forEach((function(e){parseInt(pe.a(e.date,"DDD"))<parseInt(pe.a(new Date,"DDD"))&&(e.vote="red")})),o(e)}}),[t,n]);var i=Object(F.useMutation)(K,{onError:function(e){console.log(e)}}),u=Object(I.a)(i,1)[0],d=function(){var e=Object(U.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,u({variables:{id:t.id,votes:c}});case 2:a({message:"Voted successfully",error:!1}),setTimeout((function(){a(null)}),5e3);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{children:t.name}),Object(_.jsx)(Ae,{dates:t.dates.map((function(e){return He(e.date)})),setVotes:o,votes:c}),Object(_.jsx)("button",{id:"voting-button",onClick:d,children:"Vote"}),Object(_.jsxs)("button",{id:"homepage-button",children:[" ",Object(_.jsx)(B.b,{to:"/",children:"Home Page"})]})]})},Pe=function(e){var t=e.event,n=pe.a(new Date(t.finalDate),"MMM"),a=pe.a(new Date(t.finalDate),"do");return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{children:t.name}),Object(_.jsxs)("span",{children:[n,a]}),Object(_.jsxs)("button",{id:"homepage-button",children:[" ",Object(_.jsx)(B.b,{to:"/",children:"Home Page"})]})]})},Fe=function(e){for(var t=e.month,n=e.dates,a=e.setVotes,r=e.votes,s=e.currentVote,c=e.setCurrentVote,o=ye.a(t),i=De.a(o),u=xe.a(o),d=we.a(i),j=[],l=[],b=u,m="";b<=d;){for(var O=0;O<7;O++){m=pe.a(b,"d");var h=b;l.push(Object(_.jsx)(Re,{formattedDate:m,day:h,monthStart:o,dates:n,setVotes:a,votes:r,currentVote:s,setCurrentVote:c},h)),b=fe.a(b,1)}j.push(Object(_.jsx)("div",{className:"row",children:l},b)),l=[]}return Object(_.jsx)("div",{className:"body",children:j})},Re=function(e){var t=e.formattedDate,n=e.day,a=e.monthStart,r=e.dates,s=e.votes,c=e.setVotes,o=e.currentVote,i=e.setCurrentVote,u="";return r.map((function(e){return pe.a(e,"d")})).includes(pe.a(n,"d"))?Object(_.jsx)(Le,{setVotes:c,votes:s,day:n,formattedDate:t,currentVote:o,setCurrentVote:i}):(Ne.a(n,a)||(u="disabled"),Object(_.jsxs)("div",{className:"col cell ".concat(u),children:[Object(_.jsx)("span",{className:"number",children:t}),Object(_.jsx)("span",{className:"bg",children:t})]},n))},Le=function(e){var t=e.day,n=e.formattedDate,a=e.votes,r=e.setVotes,s=e.currentVote,c=e.setCurrentVote,o=Object(k.useState)(null),i=Object(I.a)(o,2),u=i[0],d=i[1],j=Object(Ge.a)(a),l=j.findIndex((function(e){return pe.a(e.date,"DDD")===pe.a(t,"DDD")}));Object(k.useEffect)((function(){j[l]&&d(j[l].vote)}),[l]);return Object(_.jsxs)("div",{onClick:function(){return function(){console.log(s);var e=s;e>a.length&&(e=""),d(e),j[l].vote=e,r(j),c(""===e?1:e+1)}()},id:"dates-".concat(n),className:"col cell",children:[Object(_.jsx)("span",{className:"number",children:n}),Object(_.jsx)("span",{className:"bg",children:n}),u]},t)},Je=function(e){var t=e.dates,n=e.votes,a=e.setVotes,r=e.currentVote,s=e.setCurrentVote,c=Object(k.useState)(new Date),o=Object(I.a)(c,2),i=o[0],u=o[1];return Object(_.jsxs)("div",{className:"calendar",children:[Object(_.jsx)(Ue,{month:i,setMonth:u}),Object(_.jsx)(Qe,{month:i}),Object(_.jsx)(Fe,{month:i,dates:t,votes:n,setVotes:a,currentVote:r,setCurrentVote:s})]})},We=function(e){return console.log(e),new Date(e)},ze=function(e){var t=e.event,n=e.user,a=Object(F.useMutation)(K,{onError:function(e){console.log(e)}}),r=Object(I.a)(a,1)[0],s=Object(k.useState)([]),c=Object(I.a)(s,2),o=c[0],i=c[1],u=Object(k.useState)(1),d=Object(I.a)(u,2),j=d[0],l=d[1];console.log(o),Object(k.useEffect)((function(){if(t&&n){var e=t.bestDates.map((function(e){return{date:We(e.date),vote:""}}));console.log(t.bestDates[0]),0!==t.bestDates[0].votes.filter((function(e){return e.voter===n.username})).length&&(e=t.bestDates.map((function(e){return{date:We(e.date),vote:e.votes.find((function(e){return e.voter===n.username})).vote}}))),i(e)}}),[t,n]);var b=function(){var e=Object(U.a)(G.a.mark((function e(){var n;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log(t.id),n=o.map((function(e){return{date:e.date,vote:e.vote.toString()}})),console.log(n),e.next=5,r({variables:{id:t.id,votes:n}});case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{children:t.name}),"voting",Object(_.jsx)(Je,{dates:t.bestDates.map((function(e){return We(e.date)})),votes:o,setVotes:i,currentVote:j,setCurrentVote:l}),Object(_.jsx)("button",{id:"voting-button",onClick:b,children:"Vote"})]})},Ke=function(e){var t=e.setNotification,n=Object(Ee.h)().id,a=Object(F.useQuery)(ce);console.log(a);var r=Object(F.useQuery)(de,{variables:{id:n}});return console.log(r),r.data&&a.data?"done"===r.data.event.status?Object(_.jsx)("div",{children:Object(_.jsx)(Pe,{event:r.data.event})}):"voting"===r.data.event.status?Object(_.jsx)("div",{children:Object(_.jsx)(ze,{event:r.data.event,user:a.data.me,setNotification:t})}):Object(_.jsx)("div",{children:Object(_.jsx)(Ye,{user:a.data.me,event:r.data.event,setNotification:t})}):Object(_.jsx)("div",{children:"...loading"})},Xe=function(e){for(var t=e.month,n=e.dates,a=ye.a(t),r=De.a(a),s=xe.a(a),c=we.a(r),o=[],i=[],u=s,d="";u<=c;){for(var j=0;j<7;j++){d=pe.a(u,"d");var l=u;i.push(Object(_.jsx)(Ze,{formattedDate:d,day:l,monthStart:a,dates:n},l)),u=fe.a(u,1)}o.push(Object(_.jsx)("div",{className:"row",children:i},u)),i=[]}return Object(_.jsx)("div",{className:"body",children:o})},Ze=function(e){var t=e.formattedDate,n=e.day,a=e.monthStart,r=e.dates,s=Object(Ee.g)(),c=pe.a(n,"DDD");if(console.log(c),r[0]){var o=pe.a(new Date(r[0].date),"DDD");console.log(o)}var i=r.find((function(e){return pe.a(new Date(e.date),"DDD")===pe.a(n,"DDD")}));return Object(_.jsxs)("div",{onClick:function(){i&&s.push("events/".concat(i.id))},id:"dates-".concat(t),className:"col cell ".concat(Ne.a(n,a)?"":"disabled"),children:[Object(_.jsx)("span",{className:"number",children:t}),Object(_.jsx)("span",{className:"bg",children:t}),Object(_.jsx)("div",{children:i?i.name:null})]},n)},et=function(e){var t=e.events;console.log(t);var n=t.filter((function(e){return"done"===e.status})).map((function(e){return{date:e.finalDate,name:e.name,id:e.id}}));console.log(n);var a=Object(k.useState)(new Date),r=Object(I.a)(a,2),s=r[0],c=r[1];return Object(_.jsxs)("div",{className:"calendar",children:[Object(_.jsx)(Ue,{month:s,setMonth:c}),Object(_.jsx)(Qe,{month:s}),Object(_.jsx)(Xe,{month:s,dates:n})]})},tt=function(e){var t=e.events.map((function(e){return Object(_.jsx)("li",{children:Object(_.jsx)(B.b,{to:"/events/".concat(e.id),children:e.name})},e.id)}));return Object(_.jsx)("div",{children:Object(_.jsx)("ul",{children:t})})},nt=n(154),at=function(e){var t=e.logout,n=Object(F.useQuery)(ce);return n.data&&console.log(n.data.me.events),console.log(n),Object(k.useEffect)((function(){n.error&&"user needs to be logged in"===n.error.message&&t()}),[n]),n.data?Object(_.jsxs)("div",{children:[Object(_.jsxs)("h2",{children:["Hello ",n.data.me.name," "]}),Object(_.jsx)(et,{events:n.data.me.events}),Object(_.jsx)(tt,{events:n.data.me.events}),Object(_.jsx)(nt.a,{id:"addEvent-button",children:Object(_.jsx)(B.b,{to:"/addevent",children:"add event"})}),Object(_.jsx)("button",{id:"logout-button",onClick:t,children:"Log Out"}),Object(_.jsx)("button",{id:"addGroup-button",children:Object(_.jsx)(B.b,{to:"/addGroup",children:"add group"})}),Object(_.jsx)("button",{id:"groups-button",children:Object(_.jsx)(B.b,{to:"/groups",children:"groups"})}),Object(_.jsx)("button",{id:"join-group-button",children:Object(_.jsx)(B.b,{to:"/joinGroup",children:"join group"})}),Object(_.jsx)("button",{id:"messages-button",children:Object(_.jsxs)(B.b,{to:"/messages",children:["messages: ",n.data.me.unReadMessagesCount]})})]}):Object(_.jsx)(Me,{})},rt=function(){var e=Object(F.useQuery)(ue),t=e.data?e.data.me.groups.map((function(e){return Object(_.jsx)("li",{children:Object(_.jsx)(B.b,{id:e.name,to:"/groups/".concat(e.name),children:e.name})},e.id)})):[];return e.data?0===t.length&&e.data?Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{children:"It seems you aren't part any group yet"}),Object(_.jsx)("h2",{children:Object(_.jsx)(B.b,{to:"/joinGroup",children:"Join Here"})})]}):Object(_.jsx)("div",{children:Object(_.jsx)("ul",{children:t})}):Object(_.jsx)(Me,{})},st=function(e){var t=e.users,n=e.admins,a=e.group,r=e.setNotification,s=Object(Ee.g)(),c=Object(F.useQuery)(ie),o=Object(F.useMutation)(Z,{update:function(e,t){e.modify({id:"Group:".concat(a.id),fields:{users:function(e){return e.filter((function(e){return e.__ref!=="User:".concat(t.data.removeFromGroup.id)}))}}})}}),i=Object(I.a)(o,1)[0],u=Object(F.useMutation)(ee,{update:function(e,t){e.modify({id:"Group:".concat(a.id),fields:{admins:function(e){return e.concat(t)}}})}}),d=Object(I.a)(u,1)[0];if(!c.data&&a.name)return Object(_.jsx)(Me,{});var j=function(){var e=Object(U.a)(G.a.mark((function e(t){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i({variables:{user:t,group:a.name}});case 2:r({message:"removed user ".concat(t," from group"),error:!1}),setTimeout((function(){r(null)}),5e3);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),l=function(){var e=Object(U.a)(G.a.mark((function e(t){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d({variables:{user:t,group:a.name}});case 2:r({message:"added user ".concat(t," to admins"),error:!1}),setTimeout((function(){r(null)}),5e3);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=n.map((function(e){return e.id})),m=t.filter((function(e){return!b.includes(e.id)})),O=m.map((function(e){return Object(_.jsx)("li",{children:Object(_.jsx)(B.b,{to:"/users/".concat(e.username),children:e.name})},e.id)})),h=m.map((function(e){return Object(_.jsxs)("li",{children:[Object(_.jsx)(B.b,{to:"/users/".concat(e.username),children:e.name})," ",Object(_.jsx)("button",{onClick:function(){return l(e.username)},children:"add to admin"}),Object(_.jsx)("button",{onClick:function(){return j(e.username)},children:" remove "})]},e.id)})),v=b.includes(c.data.me.id)?h:O,g=n.map((function(e){return Object(_.jsx)("li",{children:Object(_.jsx)(B.b,{to:"/users/".concat(e.username),children:e.name})},e.id)}));return Object(_.jsxs)("div",{children:[Object(_.jsx)("h2",{children:"Admins"}),Object(_.jsx)("ul",{children:g}),Object(_.jsx)("h2",{children:"Users"}),Object(_.jsx)("ul",{children:v}),b.includes(c.data.me.id)?Object(_.jsx)("button",{onClick:function(){return s.push("/groups/".concat(a.name,"/addusers"))},children:" add users to group"}):null]})},ct=function(e){var t=e.setNotification,n=Object(Ee.g)(),a=Object(F.useQuery)(ie);console.log(a.data);var r=Object(F.useMutation)(X,{update:function(e,t){console.log(t);var n=e.readQuery({query:be});n&&(e.writeQuery({query:be,data:{me:Object(C.a)(Object(C.a)({},n.me),{},{groupsUserNotIn:n.me.groupsUserNotIn.concat(t.data.leaveGroup)})}}),console.log(t.data),e.modify({id:"User:".concat(a.data.me.id),fields:{groups:function(e){return e.filter((function(e){return e.__ref!=="Group:".concat(t.data.leaveGroup.id)}))}}}))}}),s=Object(I.a)(r,1)[0],c=Object(Ee.h)().name;console.log(c);var o=Object(F.useQuery)(je,{variables:{name:c}}),i=function(){var e=Object(U.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s({variables:{id:o.data.group.id}});case 2:t({message:"Left group ".concat(o.data.group.name),error:!1}),setTimeout((function(){t(null)}),5e3),n.push("/");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(!o.data)return Object(_.jsx)(Me,{});var u=o.data.group.name;return Object(_.jsxs)("div",{children:[Object(_.jsxs)("span",{children:[u,Object(_.jsx)("button",{id:"leave-button",onClick:i,children:"leave"})]}),Object(_.jsx)(st,{users:o.data.group.users,admins:o.data.group.admins,group:o.data.group,setNotification:t}),Object(_.jsx)("button",{id:"group-messages-button",children:Object(_.jsx)(B.b,{to:"/groups/".concat(o.data.group.name,"/messages"),children:"Messages"})}),Object(_.jsxs)("button",{id:"homepage-button",children:[" ",Object(_.jsx)(B.b,{to:"/",children:"Home Page"})]})]})},ot=function(){var e=Object(Ee.g)(),t=Object(Ee.h)().username,n=Object(F.useQuery)(me,{variables:{username:t}});return console.log(n),n.data?Object(_.jsxs)("div",{children:[n.data.user.name,Object(_.jsx)("button",{onClick:function(){return e.push("/sendMessage")},children:"Send Message"})]}):Object(_.jsx)("div",{children:"...loading"})},it=function(e){var t=e.group,n=e.setNotification,a=Object(F.useMutation)(re,{onError:function(e){console.log(e)}}),r=Object(I.a)(a,1)[0];return Object(_.jsx)("li",{children:Object(_.jsxs)("span",{children:[t.name,Object(_.jsx)("button",{onClick:function(){r({variables:{group:t.name}}),n({message:"Send joining request to ".concat(t.name),error:!1}),setTimeout((function(){n(null)}),5e3)},children:"Request"})]})})},ut=function(e){var t=e.setNotification,n=Object(F.useQuery)(be);return n.data?Object(_.jsxs)("div",{children:["Hello World",Object(_.jsx)("ul",{children:n.data?n.data.me.groupsUserNotIn.map((function(e){return Object(_.jsx)(it,{setNotification:t,group:e},e.id)})):null}),Object(_.jsxs)("button",{id:"homepage-button",children:[" ",Object(_.jsx)(B.b,{to:"/",children:"Home Page"})]})]}):Object(_.jsx)(Me,{})},dt=function(e){var t=e.notification;if(null===t)return null;var n="success";return t.error&&(n="error"),Object(_.jsx)("div",{id:"notification",className:n,children:t.message})},jt=function(e){var t=e.message,n=Object(F.useMutation)(ne),a=Object(I.a)(n,1)[0],r=Object(F.useMutation)(se),s=Object(I.a)(r,1)[0],c=Object(Ee.g)();return Object(_.jsx)("li",{children:Object(_.jsxs)("span",{children:[Object(_.jsx)("p",{onClick:function(){return e=t.id,a({variables:{id:e}}),void c.push("/messages/".concat(e));var e},style:{display:"inline-block",marginRight:10},children:t.title}),t.read?null:Object(_.jsx)("b",{children:"unread"}),Object(_.jsx)("button",{onClick:function(){return e=t.id,void s({variables:{id:e}});var e},children:" Delete "})]})})},lt=function(){var e=Object(F.useQuery)(oe);if(console.log(e),!e.data)return Object(_.jsx)(Me,{});var t=Object(Ge.a)(e.data.me.messages);console.log(t),t.sort((function(e,t){return console.log(e,t),e.read?t.read?0:-1:0})),t.reverse(),console.log(t);var n=t.map((function(e){return Object(_.jsx)(jt,{message:e},e.id)}));return console.log(e),0===t.length?Object(_.jsx)("div",{children:Object(_.jsx)("h1",{children:"No messages"})}):Object(_.jsx)("ul",{children:n})},bt=function(e){var t=e.message;return"Joining request"===t.type?Object(_.jsx)(mt,{message:t}):"User message"===t.type?Object(_.jsx)(Ot,{message:t}):Object(_.jsx)("div",{})},mt=function(e){var t=e.message,n=Object(F.useMutation)(te),a=Object(I.a)(n,1)[0],r=function(){var e=Object(U.a)(G.a.mark((function e(){return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a({variables:{group:t.group,user:t.sender}});case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return console.log(t),Object(_.jsxs)("div",{children:[Object(_.jsx)("br",{}),Object(_.jsx)("button",{onClick:r,children:"Accept request"})]})},Ot=function(e){var t=e.message;return Object(_.jsxs)("div",{children:[Object(_.jsx)("br",{}),Object(_.jsxs)("div",{children:["content:",t.content]})]})},ht=function(){var e=Object(Ee.h)().id,t=Object(F.useQuery)(le,{variables:{id:e}});if(console.log(t),!t.data)return Object(_.jsx)(Me,{});var n=t.data.message;return Object(_.jsxs)("div",{children:[Object(_.jsx)("span",{style:{marginRight:10},children:"title:"}),Object(_.jsx)("h2",{style:{display:"inline-block"},children:n.title}),Object(_.jsx)("br",{}),Object(_.jsxs)("span",{children:["sender: ",n.sender]}),Object(_.jsx)("br",{}),Object(_.jsxs)("span",{children:["receivers: ",n.receivers]}),Object(_.jsx)(bt,{message:n})]})},vt=function(){var e=Object(Ee.g)(),t=Object(Ee.h)().name,n=Object(F.useQuery)(Oe,{variables:{name:t}}),a=Object(F.useMutation)(te,{update:function(e,t){e.modify({id:"Group:".concat(n.data.group.id),fields:{users:function(e){return e.concat({__ref:"User:".concat(t.data.addToGroup.id)})},usersNotInGroup:function(e){return e.filter((function(e){return e.__ref!=="User:".concat(t.data.addToGroup.id)}))}}})}}),r=Object(I.a)(a,1)[0];console.log(n);var s=function(){var e=Object(U.a)(G.a.mark((function e(n){var a;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r({variables:{group:t,user:n}});case 2:a=e.sent,console.log(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();if(!n.data)return Object(_.jsx)(Me,{});var c=n.data.group.usersNotInGroup.map((function(e){return Object(_.jsxs)("li",{children:[e.username," ",Object(_.jsx)("button",{onClick:function(){return s(e.username)},children:" add "})]},e.id)}));return Object(_.jsxs)("div",{children:[Object(_.jsx)("ul",{children:c}),Object(_.jsx)("button",{onClick:function(){return e.push("/groups/".concat(n.data.group.name))},children:"Back"})]})},gt=function(){return Object(_.jsx)("div",{children:"Messages"})},pt=function(){var e=Object(F.useMutation)(ae),t=Object(I.a)(e,1)[0];return Object(_.jsxs)("div",{children:[Object(_.jsx)("h1",{children:"Send Message"}),Object(_.jsx)("div",{children:Object(_.jsx)(Q.a,{initialValues:{receivers:"",message:"",title:""},onSubmit:function(e){var n=e.receivers,a=e.title,r=e.message,s=n.split(",");s=s.map((function(e){return e.replace(/(^[ '^$*#&]+)|([ '^$*#&]+$)/g,"")})),console.log(s),t({variables:{receivers:s,message:r,title:a}})},children:function(e){var t=e.values,n=e.handleChange,a=e.handleBlur,r=e.handleSubmit,s=e.isValid;return Object(_.jsxs)("form",{onSubmit:r,children:["receivers: ",Object(_.jsx)("input",{id:"receivers",type:"text",name:"receivers",onChange:n,onBlur:a,value:t.receivers}),Object(_.jsx)("br",{}),"title: ",Object(_.jsx)("input",{id:"title",type:"text",name:"title",onChange:n,onBlur:a,value:t.title}),Object(_.jsx)("br",{}),"message:",Object(_.jsx)("br",{}),Object(_.jsx)("textarea",{id:"message",name:"message",onChange:n,onBlur:a,value:t.message}),s?Object(_.jsx)("button",{type:"submit",id:"submit-button",children:"Send"}):null]})}})})]})},xt=function(e,t){var n=Object(Ee.g)(),a=Object(F.useApolloClient)();console.log("history",n);var r=Object(F.useMutation)(W,{onError:function(e){var n=function(e){return e.startsWith("User validation failed: username:")&&e.includes("unique")?"Username needs to be unique":e}(e.graphQLErrors[0].message);t({message:n,error:!0}),setTimeout((function(){t(null)}),5e3)}}),s=Object(I.a)(r,1)[0],c=Object(F.useMutation)(L,{onError:function(e){t({message:e.graphQLErrors[0].message,error:!0}),setTimeout((function(){t(null)}),5e3)}}),o=Object(I.a)(c,1)[0];return{login:function(){var t=Object(U.a)(G.a.mark((function t(a){var r,s,c;return G.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.username,s=a.password,t.next=3,o({variables:{username:r,password:s}});case 3:c=t.sent,console.log(c),c.data.login.value&&(e(c.data.login.value),localStorage.setItem("user-token",c.data.login.value),n.push("/"));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),logout:function(){e(null),localStorage.clear(),a.resetStore()},signIn:function(){var e=Object(U.a)(G.a.mark((function e(t,n,a){var r;return G.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s({variables:{username:t,name:n,password:a}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()}},ft=function(e){var t=e.setNotification,n=Object(k.useState)(localStorage.getItem("user-token")),a=Object(I.a)(n,2),r=a[0],s=a[1],c=xt(s,t),o=c.logout,i=c.login,u=c.signIn;return Object(_.jsxs)(Ee.d,{children:[Object(_.jsx)(Ee.b,{path:"/sendMessage",children:r?Object(_.jsx)(pt,{}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/messages/:id",children:r?Object(_.jsx)(ht,{}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/messages",children:r?Object(_.jsx)(lt,{}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/joinGroup",children:r?Object(_.jsx)(ut,{setNotification:t}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/users/:username",children:r?Object(_.jsx)(ot,{}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/groups/:name/messages",children:r?Object(_.jsx)(gt,{setNotification:t}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/groups/:name/addusers",children:r?Object(_.jsx)(vt,{setNotification:t}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/groups/:name",children:r?Object(_.jsx)(ct,{setNotification:t}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/groups",children:r?Object(_.jsx)(rt,{setNotification:t}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/addGroup",children:r?Object(_.jsx)(Ie,{setNotification:t}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/SignIn",children:Object(_.jsx)(P,{login:i,signIn:u})}),Object(_.jsx)(Ee.b,{path:"/login",children:Object(_.jsx)(H,{login:i})}),Object(_.jsx)(Ee.b,{path:"/events/:id",children:r?Object(_.jsx)(Ke,{setNotification:t}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/addevent",children:r?Object(_.jsx)(Ve,{setNotification:t}):Object(_.jsx)(Ee.a,{to:"/login"})}),Object(_.jsx)(Ee.b,{path:"/",children:r?Object(_.jsx)(at,{logout:o}):Object(_.jsx)(Ee.a,{to:"/login"})})]})},yt=function(){var e=Object(k.useState)(null),t=Object(I.a)(e,2),n=t[0],a=t[1];return Object(_.jsxs)("div",{children:[Object(_.jsx)(dt,{notification:n}),Object(_.jsx)(B.a,{children:Object(_.jsx)(ft,{setNotification:a})})]})},Dt=n(155),wt=Object(Dt.a)((function(e,t){var n=t.headers,a=localStorage.getItem("user-token");return{headers:Object(C.a)(Object(C.a)({},n),{},{authorization:a?"bearer ".concat(a):null})}})),Nt=new F.HttpLink({uri:"/graphql"}),St=new F.ApolloClient({cache:new F.InMemoryCache,link:wt.concat(Nt)});V.a.render(Object(_.jsx)(F.ApolloProvider,{client:St,children:Object(_.jsx)(yt,{})}),document.getElementById("root"))},57:function(e,t,n){}},[[281,1,2]]]);
//# sourceMappingURL=main.58fd5fb5.chunk.js.map