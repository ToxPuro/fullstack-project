(this["webpackJsonpdate-selector"]=this["webpackJsonpdate-selector"]||[]).push([[0],{281:function(e,t,n){"use strict";n.r(t);var a,r,s,c,o,i,u,d,l,j,b,m,O,h,v,x,p=n(37),g=n(0),f=n(65),y=n.n(f),w=n(11),N=n(22),S=n.n(N),q=n(31),D=n(53),E=n(13),$=n(49),k=n(1),C=$.a().shape({username:$.b().required("Username is required").min(3,"Username needs to be atleast 3 characters"),password:$.b().required("Password is required").min(8,"Password needs to be atleast 8 characters")}),I=function(e){var t=e.login;return Object(k.jsxs)("div",{children:[Object(k.jsx)("h1",{children:"Login"}),Object(k.jsx)(D.a,{initialValues:{username:"",password:""},onSubmit:function(){var e=Object(q.a)(S.a.mark((function e(n,a){var r,s,c;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.username,s=n.password,c=a.resetForm,e.next=4,t({username:r,password:s});case 4:c({values:{username:"",password:""}});case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),validationSchema:C,children:function(e){var t=e.values,n=e.handleChange,a=e.handleBlur,r=e.handleSubmit,s=e.isValid,c=e.dirty;return Object(k.jsxs)("form",{onSubmit:r,children:["username: ",Object(k.jsx)("input",{id:"username",type:"text",name:"username",onChange:n,onBlur:a,value:t.username}),Object(k.jsx)("br",{}),"password: ",Object(k.jsx)("input",{id:"password",type:"password",name:"password",onChange:n,onBlur:a,value:t.password}),Object(k.jsx)("br",{}),s&&c?Object(k.jsx)("button",{type:"submit",id:"login-button",children:"Login"}):null]})}}),Object(k.jsx)("h2",{children:"Not yet signed in?"}),Object(k.jsx)("button",{id:"signIn-button",children:Object(k.jsx)(E.b,{to:"SignIn",children:"Sign In"})})]})},M=$.a().shape({username:$.b().required("Username is required"),name:$.b().required("Name is required"),password:$.b().required("Password is required")}),G=function(e){var t=e.login,n=e.signIn,a=function(){var e=Object(q.a)(S.a.mark((function e(a,r){var s,c,o,i;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=a.username,c=a.name,o=a.password,i=r.resetForm,e.next=4,n(s,c,o);case 4:if(!e.sent){e.next=8;break}return e.next=8,t({username:s,password:o});case 8:i({values:{username:"",password:"",name:""}});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(k.jsxs)("div",{children:[Object(k.jsx)("h1",{children:"Sign In"}),Object(k.jsx)(D.a,{initialValues:{username:"",password:"",name:""},onSubmit:a,validationSchema:M,children:function(e){var t=e.values,n=e.handleChange,a=e.handleBlur,r=e.handleSubmit,s=e.isValid,c=e.dirty;return Object(k.jsxs)("form",{onSubmit:r,children:["username: ",Object(k.jsx)("input",{id:"username",type:"text",name:"username",onChange:n,onBlur:a,value:t.username}),Object(k.jsx)("br",{}),"name: ",Object(k.jsx)("input",{id:"name",type:"text",name:"name",onChange:n,onBlur:a,value:t.name}),Object(k.jsx)("br",{}),"password: ",Object(k.jsx)("input",{id:"password",type:"text",name:"password",onChange:n,onBlur:a,value:t.password}),Object(k.jsx)("br",{}),s&&c?Object(k.jsx)("button",{type:"submit",id:"submit-button",children:"Sign In"}):null]})}})]})},Q=n(6),V=n(23),U=Object(Q.gql)(a||(a=Object(V.a)(["\nmutation login($username: String!, $password: String!){\n  login(username: $username, password: $password){value}\n}"]))),Y=Object(Q.gql)(r||(r=Object(V.a)(["\nmutation addEvent($name: String! $group: String! $dates: [String!]!){\n  addEvent(name: $name, group: $group dates: $dates){name id}\n}"]))),B=Object(Q.gql)(s||(s=Object(V.a)(["\nmutation createUser($name: String! $username: String! $password: String!){\n  createUser(name: $name, username: $username, password: $password){name}\n}"]))),H=Object(Q.gql)(c||(c=Object(V.a)(["\nmutation addGroup($name: String! $users: [String]!){\n  createGroup(name: $name, users: $users){name}\n}"]))),_=Object(Q.gql)(o||(o=Object(V.a)(["\nmutation joinGroup($id: ID!){\n  joinGroup(id: $id){\n    name \n    id\n  }\n}"]))),A=Object(Q.gql)(i||(i=Object(V.a)(["\nmutation voteEvent($id: ID!, $votes: [VoteInput]!){\n  voteEvent(id: $id, votes: $votes){\n    name \n    id\n    status \n    dates{\n      votes{\n        voter \n        vote}\n      }\n    }\n}"]))),P=Object(Q.gql)(u||(u=Object(V.a)(["\nmutation leaveGroup($id: ID!){\n  leaveGroup(id: $id){\n    name\n    id\n  }\n}"]))),L=Object(Q.gql)(d||(d=Object(V.a)(["\nquery{\n  me{\n    name\n    username\n    id\n    events{\n      name\n      id\n      status\n      finalDate\n    }\n  }\n}"]))),T=Object(Q.gql)(l||(l=Object(V.a)(["\nquery{\n  me{\n    id\n  }\n}"]))),F=(Object(Q.gql)(j||(j=Object(V.a)(["\nquery{\n  allEvents{\n    name\n  }\n}"]))),Object(Q.gql)(b||(b=Object(V.a)(["\nquery{\n  me{\n    id\n    groups{\n      name\n      id\n    }\n  }\n}"])))),J=Object(Q.gql)(m||(m=Object(V.a)(["\nquery event($id: ID!){\n  event(id: $id){\n    name\n    id\n    status\n    dates{\n      date\n      votes{\n        voter\n        vote\n      }\n    }\n  }\n}"]))),W=Object(Q.gql)(O||(O=Object(V.a)(["\nquery group($id: ID!){\n  group(id: $id){\n    name\n    id\n    users{\n      name\n      username\n      id\n    }\n  }\n}"]))),z=Object(Q.gql)(h||(h=Object(V.a)(["\nquery{\n  me{\n    id\n    groupsUserNotIn{\n      name\n      id\n    }\n  }\n}"]))),K=Object(Q.gql)(v||(v=Object(V.a)(["\nquery user($username: String!){\n  user(username: $username){\n    name\n    id\n  }\n}"]))),R=(Object(Q.gql)(x||(x=Object(V.a)(["\nquery{\n  allGroups{\n    name\n    id\n  }\n}"]))),n(153)),X=n(151),Z=n(282),ee=n(289),te=n(283),ne=n(284),ae=n(285),re=n(286),se=n(287),ce=n(288),oe=(n(99),function(e){var t=e.month,n=e.setMonth;return Object(k.jsxs)("div",{className:"header row flex-middle",children:[Object(k.jsx)("div",{className:"col col-start",children:Object(k.jsx)("div",{className:"icon",onClick:function(){n(Z.a(t,1))},children:"chevron_left"})}),Object(k.jsx)("div",{className:"col col-center",children:Object(k.jsx)("span",{children:ee.a(t,"MMMM YYYYY")})}),Object(k.jsx)("div",{className:"col col-end",onClick:function(){n(X.a(t,1))},children:Object(k.jsx)("div",{className:"icon",children:"chevron_right"})})]})}),ie=function(e){var t=e.month,n=te.a(t),a=Array.from(Array(7)).map((function(e,t){return Object(k.jsx)("div",{className:"col col-center",children:ee.a(ne.a(n,t),"EEEEEE")},t)}));return Object(k.jsx)("div",{className:"days row",children:a})},ue=function(e){for(var t=e.month,n=e.setDates,a=e.dates,r=ae.a(t),s=re.a(r),c=te.a(r),o=se.a(s),i=[],u=[],d=c,l="";d<=o;){for(var j=0;j<7;j++){l=ee.a(d,"d");var b=d;u.push(Object(k.jsx)(de,{formattedDate:l,day:b,monthStart:r,setDates:n,dates:a},b)),d=ne.a(d,1)}i.push(Object(k.jsx)("div",{className:"row",children:u},d)),u=[]}return Object(k.jsx)("div",{className:"body",children:i})},de=function(e){var t=e.formattedDate,n=e.day,a=e.monthStart,r=e.setDates,s=e.dates,c=Object(g.useState)(!1),o=Object(w.a)(c,2),i=o[0],u=o[1],d="col cell default";return ce.a(n,a)||(d="col cell disabled"),i&&(d="col cell green"),Object(k.jsxs)("div",{id:"dates-".concat(t),className:d,onClick:function(){return function(e){u(!i),r(s.concat(e))}(n)},children:[Object(k.jsx)("span",{className:"number",children:t}),Object(k.jsx)("span",{className:"bg",children:t})]},n)},le=function(e){var t=e.setDates,n=e.dates,a=Object(g.useState)(new Date),r=Object(w.a)(a,2),s=r[0],c=r[1];return Object(k.jsxs)("div",{className:"calendar",children:[Object(k.jsx)(oe,{month:s,setMonth:c}),Object(k.jsx)(ie,{month:s}),Object(k.jsx)(ue,{month:s,setDates:t,dates:n})]})},je=function(){return Object(k.jsx)("div",{children:"...loading"})},be=function(e){var t=e.setNotification,n=Object(g.useState)([]),a=Object(w.a)(n,2),r=a[0],s=a[1],c=Object(g.useState)(null),o=Object(w.a)(c,2),i=o[0],u=o[1],d=Object(Q.useQuery)(F),l=[];d.data&&(l=d.data.me.groups.map((function(e){return{value:e.name,label:e.name}})));var j=Object(Q.useMutation)(Y,{update:function(e,t){console.log("dataInStore:");var n=e.readQuery({query:L});if(n){var a=n.me.events;console.log(n.me),console.log(a),console.log(t),e.writeQuery({query:L,data:{me:Object(p.a)(Object(p.a)({},n.me),{},{events:a.concat(t.data.addEvent)})}})}}}),b=Object(w.a)(j,1)[0];return d.data?0===l.length&&d.data?Object(k.jsxs)("div",{children:[Object(k.jsx)("h2",{children:"You need to be part of group to add events"}),Object(k.jsx)("h2",{children:Object(k.jsx)(E.b,{to:"/joinGroup",children:"Join Here"})})]}):Object(k.jsxs)("div",{children:[Object(k.jsx)("h1",{children:"New Event"}),Object(k.jsx)(D.a,{initialValues:{name:""},onSubmit:function(e,n){var a=e.name,s=n.resetForm;0===r.length?(t({message:"pick possible dates",error:!0}),setTimeout((function(){t(null)}),5e3)):i?(b({variables:{name:a,group:i,dates:r}}),t({message:"added event ".concat(a," to group ").concat(i),error:!1}),setTimeout((function(){t(null)}),5e3),s({})):(t({message:"pick group to add event",error:!0}),setTimeout((function(){t(null)}),5e3))},children:function(e){var t=e.values,n=e.handleChange,a=e.handleBlur,r=e.handleSubmit;return Object(k.jsxs)("form",{onSubmit:r,children:["event name: ",Object(k.jsx)("input",{id:"name",type:"text",name:"name",onChange:n,onBlur:a,value:t.name}),Object(k.jsx)("button",{id:"submit-button",type:"submit",children:"Submit"})]})}}),Object(k.jsx)(R.a,{id:"group-options",options:l,onChange:function(e){u(e.value)}}),Object(k.jsx)("h2",{children:"Choose possible days"}),Object(k.jsx)(le,{dates:r,setDates:s}),Object(k.jsxs)("button",{id:"homepage-button",children:[" ",Object(k.jsx)(E.b,{to:"/",children:"Home Page"})]})]}):Object(k.jsx)(je,{})},me=function(){var e=Object(Q.useMutation)(H),t=Object(w.a)(e,1)[0],n=Object(g.useState)([]),a=Object(w.a)(n,2),r=a[0],s=a[1];return Object(k.jsxs)("div",{children:[Object(k.jsx)("h1",{children:"New Group"}),Object(k.jsx)(D.a,{initialValues:{name:"",user:""},onSubmit:function(){var e=Object(q.a)(S.a.mark((function e(n,a){var s,c,o;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s=n.name,c=a.resetForm,console.log(s),console.log(r),e.next=6,t({variables:{name:s,users:r}});case 6:o=e.sent,console.log(o.data),c({});case 9:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),children:function(e){var t=e.values,n=e.handleChange,a=e.handleBlur,c=e.handleSubmit,o=e.setFieldValue;return Object(k.jsxs)("form",{onSubmit:c,children:["group name: ",Object(k.jsx)("input",{id:"name",type:"text",name:"name",onChange:n,onBlur:a,value:t.name}),Object(k.jsx)("br",{}),"users: ",Object(k.jsx)("input",{id:"user",type:"text",name:"user",onChange:n,onBlur:a,value:t.user}),Object(k.jsx)("button",{type:"button",id:"add-user-button",onClick:function(){s(r.concat(t.user)),o("user","")},children:"add user"}),Object(k.jsx)("br",{}),r.join(" "),Object(k.jsx)("br",{}),Object(k.jsx)("button",{id:"submit-button",type:"submit",children:"Submit"})]})}}),Object(k.jsxs)("button",{id:"homepage-button",children:[" ",Object(k.jsx)(E.b,{to:"/",children:"Home Page"})]})]})},Oe=n(20),he=n(24),ve=function(e){var t=e.month,n=e.setMonth;return Object(k.jsxs)("div",{className:"header row flex-middle",children:[Object(k.jsx)("div",{className:"col col-start",children:Object(k.jsx)("div",{className:"icon",onClick:function(){n(Z.a(t,1))},children:"chevron_left"})}),Object(k.jsx)("div",{className:"col col-center",children:Object(k.jsx)("span",{children:ee.a(t,"MMMM YYYYY")})}),Object(k.jsx)("div",{className:"col col-end",onClick:function(){n(X.a(t,1))},children:Object(k.jsx)("div",{className:"icon",children:"chevron_right"})})]})},xe=function(e){var t=e.month,n=te.a(t),a=Array.from(Array(7)).map((function(e,t){return Object(k.jsx)("div",{className:"col col-center",children:ee.a(ne.a(n,t),"EEEEEE")},t)}));return Object(k.jsx)("div",{className:"days row",children:a})},pe=function(e){for(var t=e.month,n=e.dates,a=e.setVotes,r=e.votes,s=ae.a(t),c=re.a(s),o=te.a(s),i=se.a(c),u=[],d=[],l=o,j="";l<=i;){for(var b=0;b<7;b++){j=ee.a(l,"d");var m=l;d.push(Object(k.jsx)(fe,{formattedDate:j,day:m,monthStart:s,dates:n,setVotes:a,votes:r},m)),l=ne.a(l,1)}u.push(Object(k.jsx)("div",{className:"row",children:d},l)),d=[]}return Object(k.jsx)("div",{className:"body",children:u})},ge=function(e){var t=e.day,n=e.formattedDate,a=e.votes,r=e.setVotes,s=Object(g.useState)(""),c=Object(w.a)(s,2),o=c[0],i=c[1],u=Object(he.a)(a);console.log(u);var d=u.findIndex((function(e){return ee.a(e.date,"DDD")===ee.a(t,"DDD")}));Object(g.useEffect)((function(){u[d]&&i(u[d].vote)}),[d]);return console.log(o),Object(k.jsxs)("div",{onClick:function(){return function(e){"blue"===e?(i("green"),u[d].vote="green",r(u)):"green"===e?(i("red"),u[d].vote="red",r(u)):(i("blue"),u[d].vote="blue",r(u))}(o)},id:"dates-".concat(n),className:"col cell ".concat(o),children:[Object(k.jsx)("span",{className:"number",children:n}),Object(k.jsx)("span",{className:"bg",children:n})]},t)},fe=function(e){var t=e.formattedDate,n=e.day,a=e.monthStart,r=e.dates,s=e.setVotes,c=e.votes;return r.map((function(e){return ee.a(e,"d")})).includes(ee.a(n,"d"))?(console.log("FOUND"),Object(k.jsx)(ge,{setVotes:s,votes:c,day:n,formattedDate:t})):Object(k.jsxs)("div",{className:"col cell ".concat(ce.a(n,a)?"":"disabled"),children:[Object(k.jsx)("span",{className:"number",children:t}),Object(k.jsx)("span",{className:"bg",children:t})]},n)},ye=function(e){var t=e.dates,n=e.setVotes,a=e.votes,r=Object(g.useState)(new Date),s=Object(w.a)(r,2),c=s[0],o=s[1];return Object(k.jsxs)("div",{className:"calendar",children:[Object(k.jsx)(ve,{month:c,setMonth:o}),Object(k.jsx)(xe,{month:c}),Object(k.jsx)(pe,{month:c,dates:t,setVotes:n,votes:a})]})},we=function(e){return console.log(e),new Date(e)},Ne=function(e){var t=e.setNotification,n=Object(g.useState)([]),a=Object(w.a)(n,2),r=a[0],s=a[1],c=Object(Q.useMutation)(A,{onError:function(e){console.log(e)}}),o=Object(w.a)(c,2),i=o[0],u=o[1],d=function(){var e=Object(q.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i({variables:{id:b.data.event.id,votes:r}});case 2:t({message:"Voted successfully",error:!1}),setTimeout((function(){t(null)}),5e3);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();console.log(u);var l=Object(Oe.h)().id,j=Object(Q.useQuery)(L);console.log(j);var b=Object(Q.useQuery)(J,{variables:{id:l}});return console.log(b),Object(g.useEffect)((function(){if(b.data&&j.data){console.log(b.data.event),console.log(b.data.event.dates),console.log("User",j.data.me.username);var e=b.data.event.dates.map((function(e){return{date:we(e.date),vote:"blue"}}));0!==b.data.event.dates[0].votes.filter((function(e){return e.voter===j.data.me.username})).length&&(e=b.data.event.dates.map((function(e){return{date:we(e.date),vote:e.votes.find((function(e){return e.voter===j.data.me.username})).vote}}))),s(e)}}),[b.data,j.data]),b.data?(console.log(r),Object(k.jsxs)("div",{children:[b.data.event.name,Object(k.jsx)(ye,{dates:b.data.event.dates.map((function(e){return we(e.date)})),setVotes:s,votes:r}),Object(k.jsx)("button",{id:"voting-button",onClick:d,children:"Vote"}),Object(k.jsxs)("button",{id:"homepage-button",children:[" ",Object(k.jsx)(E.b,{to:"/",children:"Home Page"})]})]})):Object(k.jsx)("div",{children:"...loading"})},Se=function(e){var t=e.month,n=e.setMonth;return Object(k.jsxs)("div",{className:"header row flex-middle",children:[Object(k.jsx)("div",{className:"col col-start",children:Object(k.jsx)("div",{className:"icon",onClick:function(){n(Z.a(t,1))},children:"chevron_left"})}),Object(k.jsx)("div",{className:"col col-center",children:Object(k.jsx)("span",{children:ee.a(t,"MMMM YYYYY")})}),Object(k.jsx)("div",{className:"col col-end",onClick:function(){n(X.a(t,1))},children:Object(k.jsx)("div",{className:"icon",children:"chevron_right"})})]})},qe=function(e){var t=e.month,n=te.a(t),a=Array.from(Array(7)).map((function(e,t){return Object(k.jsx)("div",{className:"col col-center",children:ee.a(ne.a(n,t),"EEEEEE")},t)}));return Object(k.jsx)("div",{className:"days row",children:a})},De=function(e){for(var t=e.month,n=e.dates,a=ae.a(t),r=re.a(a),s=te.a(a),c=se.a(r),o=[],i=[],u=s,d="";u<=c;){for(var l=0;l<7;l++){d=ee.a(u,"d");var j=u;i.push(Object(k.jsx)(Ee,{formattedDate:d,day:j,monthStart:a,dates:n},j)),u=ne.a(u,1)}o.push(Object(k.jsx)("div",{className:"row",children:i},u)),i=[]}return Object(k.jsx)("div",{className:"body",children:o})},Ee=function(e){var t=e.formattedDate,n=e.day,a=e.monthStart,r=e.dates.find((function(e){return ee.a(new Date(e.date),"DDD")===ee.a(n,"DDD")}));return Object(k.jsxs)("div",{id:"dates-".concat(t),className:"col cell ".concat(ce.a(n,a)?"":"disabled"),children:[Object(k.jsx)("span",{className:"number",children:t}),Object(k.jsx)("span",{className:"bg",children:t}),Object(k.jsx)("div",{children:r?r.name:null})]},n)},$e=function(e){var t=e.events;console.log(t);var n=t.filter((function(e){return"done"===e.status})).map((function(e){return{date:e.finalDate,name:e.name}}));console.log(n);var a=Object(g.useState)(new Date),r=Object(w.a)(a,2),s=r[0],c=r[1];return Object(k.jsxs)("div",{className:"calendar",children:[Object(k.jsx)(Se,{month:s,setMonth:c}),Object(k.jsx)(qe,{month:s}),Object(k.jsx)(De,{month:s,dates:n})]})},ke=function(e){var t=e.events.map((function(e){return Object(k.jsx)("li",{children:Object(k.jsx)(E.b,{to:"/events/".concat(e.id),children:e.name})},e.id)}));return Object(k.jsx)("div",{children:Object(k.jsx)("ul",{children:t})})},Ce=n(154),Ie=function(e){var t=e.logout,n=Object(Q.useQuery)(L);return n.data&&console.log(n.data.me.events),Object(g.useEffect)((function(){n.error&&"user needs to be logged in"===n.error.message&&t()}),[n]),n.data?Object(k.jsxs)("div",{children:[Object(k.jsxs)("h2",{children:["Hello ",n.data.me.name," "]}),Object(k.jsx)($e,{events:n.data.me.events}),Object(k.jsx)(ke,{events:n.data.me.events}),Object(k.jsx)(Ce.a,{id:"addEvent-button",children:Object(k.jsx)(E.b,{to:"/addevent",children:"add event"})}),Object(k.jsx)("button",{id:"logout-button",onClick:t,children:"Log Out"}),Object(k.jsx)("button",{id:"addGroup-button",children:Object(k.jsx)(E.b,{to:"/addGroup",children:"add group"})}),Object(k.jsx)("button",{id:"groups-button",children:Object(k.jsx)(E.b,{to:"/groups",children:"groups"})}),Object(k.jsx)("button",{id:"join-group-button",children:Object(k.jsx)(E.b,{to:"/joinGroup",children:"join group"})})]}):Object(k.jsx)(je,{})},Me=function(){var e=Object(Q.useQuery)(F),t=e.data?e.data.me.groups.map((function(e){return Object(k.jsx)("li",{children:Object(k.jsx)(E.b,{to:"/groups/".concat(e.id),children:e.name})},e.name)})):[];return e.data?0===t.length&&e.data?Object(k.jsxs)("div",{children:[Object(k.jsx)("h2",{children:"It seems you aren't part any group yet"}),Object(k.jsx)("h2",{children:Object(k.jsx)(E.b,{to:"/joinGroup",children:"Join Here"})})]}):Object(k.jsx)("div",{children:Object(k.jsx)("ul",{children:t})}):Object(k.jsx)(je,{})},Ge=function(e){var t=e.users.map((function(e){return Object(k.jsx)("li",{children:Object(k.jsx)(E.b,{to:"/users/".concat(e.username),children:e.name})},e.id)}));return Object(k.jsx)("div",{children:Object(k.jsx)("ul",{children:t})})},Qe=function(e){var t=e.setNotification,n=Object(Oe.g)(),a=Object(Q.useQuery)(T);console.log(a.data);var r=Object(Q.useMutation)(P,{update:function(e,t){console.log(t);var n=e.readQuery({query:z});n&&(e.writeQuery({query:z,data:{me:Object(p.a)(Object(p.a)({},n.me),{},{groupsUserNotIn:n.me.groupsUserNotIn.concat(t.data.leaveGroup)})}}),console.log(t.data),e.modify({id:"User:".concat(a.data.me.id),fields:{groups:function(e){return e.filter((function(e){return e.__ref!=="Group:".concat(t.data.leaveGroup.id)}))}}}))}}),s=Object(w.a)(r,1)[0],c=Object(Oe.h)().id,o=Object(Q.useQuery)(W,{variables:{id:c}}),i=function(){var e=Object(q.a)(S.a.mark((function e(){return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s({variables:{id:o.data.group.id}});case 2:t({message:"Left group ".concat(o.data.group.name),error:!1}),setTimeout((function(){t(null)}),5e3),n.push("/");case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return o.data?Object(k.jsxs)("div",{children:[Object(k.jsxs)("span",{children:[o.data.group.name,Object(k.jsx)("button",{onClick:i,children:"leave"})]}),Object(k.jsx)(Ge,{users:o.data.group.users}),Object(k.jsxs)("button",{id:"homepage-button",children:[" ",Object(k.jsx)(E.b,{to:"/",children:"Home Page"})]})]}):Object(k.jsx)(je,{})},Ve=function(){var e=Object(Oe.h)().username,t=Object(Q.useQuery)(K,{variables:{username:e}});return console.log(t),t.data?Object(k.jsx)("div",{children:t.data.user.name}):Object(k.jsx)("div",{children:"...loading"})},Ue=function(e){var t=e.group,n=e.user,a=Object(Q.useMutation)(_,{update:function(e,t){var a=e.readQuery({query:F});console.log(a),console.log(t),a&&e.writeQuery({query:F,data:{me:Object(p.a)(Object(p.a)({},a.me),{},{groups:a.me.groups.concat(t.data.joinGroup)})}}),console.log(n.id),e.modify({id:"User:".concat(n.id),fields:{groupsUserNotIn:function(e){return e.filter((function(e){return e.__ref!=="Group:".concat(t.data.joinGroup.id)}))}}})}}),r=Object(w.a)(a,1)[0];return Object(k.jsx)("li",{children:Object(k.jsxs)("span",{children:[t.name,Object(k.jsx)("button",{onClick:function(){return r({variables:{id:t.id}})},children:"Join"})]})})},Ye=function(){var e=Object(Q.useQuery)(z),t=Object(Q.useQuery)(T);return e.data&&t.data?Object(k.jsxs)("div",{children:["Hello World",Object(k.jsx)("ul",{children:e.data?e.data.me.groupsUserNotIn.map((function(e){return Object(k.jsx)(Ue,{group:e,user:t.data.me},e.id)})):null}),Object(k.jsxs)("button",{id:"homepage-button",children:[" ",Object(k.jsx)(E.b,{to:"/",children:"Home Page"})]})]}):Object(k.jsx)(je,{})},Be=function(e){var t=e.notification;if(null===t)return null;var n="success";return t.error&&(n="error"),Object(k.jsx)("div",{id:"notification",className:n,children:t.message})},He=function(e,t){var n=Object(Oe.g)(),a=Object(Q.useApolloClient)();console.log("history",n);var r=Object(Q.useMutation)(B,{onError:function(e){var n=function(e){return e.startsWith("User validation failed: username:")&&e.includes("unique")?"Username needs to be unique":e}(e.graphQLErrors[0].message);t({message:n,error:!0}),setTimeout((function(){t(null)}),5e3)}}),s=Object(w.a)(r,1)[0],c=Object(Q.useMutation)(U,{onError:function(e){t({message:e.graphQLErrors[0].message,error:!0}),setTimeout((function(){t(null)}),5e3)}}),o=Object(w.a)(c,1)[0];return{login:function(){var t=Object(q.a)(S.a.mark((function t(a){var r,s,c;return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=a.username,s=a.password,t.next=3,o({variables:{username:r,password:s}});case 3:c=t.sent,console.log(c),c.data.login.value&&(e(c.data.login.value),localStorage.setItem("user-token",c.data.login.value),n.push("/"));case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),logout:function(){e(null),localStorage.clear(),a.resetStore()},signIn:function(){var e=Object(q.a)(S.a.mark((function e(t,n,a){var r;return S.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s({variables:{username:t,name:n,password:a}});case 2:return r=e.sent,e.abrupt("return",r);case 4:case"end":return e.stop()}}),e)})));return function(t,n,a){return e.apply(this,arguments)}}()}},_e=function(e){var t=e.setNotification,n=Object(g.useState)(localStorage.getItem("user-token")),a=Object(w.a)(n,2),r=a[0],s=a[1],c=He(s,t),o=c.logout,i=c.login,u=c.signIn;return Object(k.jsxs)(Oe.d,{children:[Object(k.jsx)(Oe.b,{path:"/joinGroup",children:r?Object(k.jsx)(Ye,{}):Object(k.jsx)(Oe.a,{to:"/login"})}),Object(k.jsx)(Oe.b,{path:"/users/:username",children:r?Object(k.jsx)(Ve,{}):Object(k.jsx)(Oe.a,{to:"/login"})}),Object(k.jsx)(Oe.b,{path:"/groups/:id",children:r?Object(k.jsx)(Qe,{setNotification:t}):Object(k.jsx)(Oe.a,{to:"/login"})}),Object(k.jsx)(Oe.b,{path:"/groups",children:r?Object(k.jsx)(Me,{}):Object(k.jsx)(Oe.a,{to:"/login"})}),Object(k.jsx)(Oe.b,{path:"/addGroup",children:r?Object(k.jsx)(me,{}):Object(k.jsx)(Oe.a,{to:"/login"})}),Object(k.jsx)(Oe.b,{path:"/SignIn",children:Object(k.jsx)(G,{login:i,signIn:u})}),Object(k.jsx)(Oe.b,{path:"/login",children:Object(k.jsx)(I,{login:i})}),Object(k.jsx)(Oe.b,{path:"/events/:id",children:r?Object(k.jsx)(Ne,{setNotification:t}):Object(k.jsx)(Oe.a,{to:"/login"})}),Object(k.jsx)(Oe.b,{path:"/addevent",children:r?Object(k.jsx)(be,{setNotification:t}):Object(k.jsx)(Oe.a,{to:"/login"})}),Object(k.jsx)(Oe.b,{path:"/",children:r?Object(k.jsx)(Ie,{logout:o}):Object(k.jsx)(Oe.a,{to:"/login"})})]})},Ae=function(){var e=Object(g.useState)(null),t=Object(w.a)(e,2),n=t[0],a=t[1];return Object(k.jsxs)("div",{children:[Object(k.jsx)(Be,{notification:n}),Object(k.jsx)(E.a,{children:Object(k.jsx)(_e,{setNotification:a})})]})},Pe=n(155),Le=Object(Pe.a)((function(e,t){var n=t.headers,a=localStorage.getItem("user-token");return{headers:Object(p.a)(Object(p.a)({},n),{},{authorization:a?"bearer ".concat(a):null})}})),Te=new Q.HttpLink({uri:"/graphql"}),Fe=new Q.ApolloClient({cache:new Q.InMemoryCache,link:Le.concat(Te)});y.a.render(Object(k.jsx)(Q.ApolloProvider,{client:Fe,children:Object(k.jsx)(Ae,{})}),document.getElementById("root"))},99:function(e,t,n){}},[[281,1,2]]]);
//# sourceMappingURL=main.bcee2ca5.chunk.js.map